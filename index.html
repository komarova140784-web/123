<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•–û–ó–Ø–ï–í–ê EMPIRE</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ */
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --secondary: #ec4899;
            --accent: #06b6d4;
            --background: #0f172a;
            --surface: #1e293b;
            --surface-light: #334155;
            --text: #f1f5f9;
            --text-secondary: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            
            /* –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã */
            --gradient-primary: linear-gradient(135deg, var(--primary), var(--secondary));
            --gradient-dark: linear-gradient(135deg, #1e1b4b, #312e81);
            --gradient-success: linear-gradient(135deg, var(--success), #34d399);
            
            /* –¢–µ–Ω–∏ */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);
            --shadow-neon: 0 0 20px rgba(139, 92, 246, 0.5);
            --shadow-neon-lg: 0 0 40px rgba(139, 92, 246, 0.7);
            
            /* –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏—è */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
            
            /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
            --transition-fast: 150ms ease;
            --transition-normal: 300ms ease;
            --transition-slow: 500ms ease;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(99, 102, 241, 0.1) 0%, transparent 40%);
            overflow-x: hidden;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è header */
        header {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            height: 64px;
            padding: 0 20px;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 20px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: var(--shadow-neon);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .radio-inputs {
            display: flex;
            gap: 8px;
            background: var(--surface);
            padding: 8px;
            border-radius: var(--radius-lg);
            max-width: 400px;
            margin: 20px auto;
            box-shadow: var(--shadow-md);
        }

        .radio {
            flex: 1;
        }

        .radio input[type="radio"] {
            display: none;
        }

        .radio .name {
            display: block;
            padding: 12px 20px;
            text-align: center;
            background: transparent;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-normal);
            color: var(--text-secondary);
            font-weight: 500;
        }

        .radio input[type="radio"]:checked + .name {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-neon);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            padding: 32px;
            margin-bottom: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            transition: var(--transition-normal);
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg), var(--shadow-neon);
            border-color: rgba(139, 92, 246, 0.3);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            animation: border-flow 3s linear infinite;
        }

        @keyframes border-flow {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .card h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ */
        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: rgba(51, 65, 85, 0.3);
            border-radius: var(--radius-lg);
            margin-bottom: 12px;
            transition: var(--transition-normal);
            border-left: 4px solid transparent;
        }

        .info-row:hover {
            background: rgba(51, 65, 85, 0.5);
            border-left-color: var(--primary);
            transform: translateX(8px);
        }

        .info-row strong {
            color: var(--text);
            font-weight: 600;
            min-width: 200px;
        }

        .info-row span {
            color: var(--text-secondary);
        }

        /* –ê–≤–∞—Ç–∞—Ä */
        .avatar-container {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-bottom: 32px;
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 30%;
            object-fit: cover;
            border: 4px solid transparent;
            background: var(--gradient-primary);
            padding: 4px;
            box-shadow: var(--shadow-neon);
            transition: var(--transition-normal);
        }

        .avatar:hover {
            transform: scale(1.05) rotate(5deg);
            box-shadow: var(--shadow-neon-lg);
        }

        /* –ë–µ–π–¥–∂–∏ */
        .badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 4px;
        }

        .badge.vip {
            background: linear-gradient(135deg, #fcd34d, #f59e0b);
            color: #000;
        }

        .badge.rank {
            background: var(--gradient-primary);
            color: white;
        }

        .badge.admin {
            background: var(--gradient-success);
            color: white;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border-radius: var(--radius-lg);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            border: none;
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: var(--transition-slow);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-neon);
        }

        .btn.purple {
            background: var(--gradient-primary);
            color: white;
        }

        .btn.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        /* –°–µ–∫—Ü–∏–∏ */
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –°–µ—Ç–∫–∏ */
        .property-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        /* –ì—Ä–∞—Ñ–∏–∫ */
        .chart-container {
            background: rgba(30, 41, 59, 0.5);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-top: 24px;
            height: 300px;
        }

        /* –õ–æ–≥–∏ */
        .log-item {
            background: var(--surface);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary);
            transition: var(--transition-normal);
        }

        .log-item:hover {
            transform: translateX(8px);
            box-shadow: var(--shadow-md);
        }

        .log-item.finance {
            border-left-color: var(--success);
        }

        .log-item.system {
            border-left-color: var(--info);
        }

        .log-item.error {
            border-left-color: var(--danger);
        }

        /* –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π */
        .user-card {
            background: var(--surface);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition-normal);
        }

        .user-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .user-status {
            padding: 6px 12px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
        }

        .status-online {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-offline {
            background: rgba(100, 116, 139, 0.2);
            color: var(--text-secondary);
            border: 1px solid var(--text-secondary);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: var(--surface);
            border-radius: var(--radius-xl);
            padding: 32px;
            max-width: 500px;
            margin: 10% auto;
            position: relative;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .close {
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition-fast);
        }

        .close:hover {
            color: var(--text);
        }

        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text);
            font-weight: 500;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(51, 65, 85, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: var(--text);
            font-size: 16px;
            transition: var(--transition-normal);
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            backdrop-filter: blur(10px);
        }

        .loading-indicator {
            text-align: center;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(139, 92, 246, 0.3);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            z-index: 4000;
            animation: toastSlideIn 0.3s ease;
            max-width: 400px;
            border-left: 4px solid var(--primary);
        }

        @keyframes toastSlideIn {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }

        .toast.success {
            border-left-color: var(--success);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container {
                padding: 0 16px;
            }
            
            .card {
                padding: 24px 16px;
            }
            
            .avatar-container {
                flex-direction: column;
                text-align: center;
            }
            
            .property-grid {
                grid-template-columns: 1fr;
            }
            
            .radio-inputs {
                flex-direction: column;
            }
            
            .modal-content {
                margin: 20% 16px;
                padding: 24px;
            }
        }

        /* –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--surface);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--surface-light);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã */
        .text-gradient {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .shadow-neon {
            box-shadow: var(--shadow-neon);
        }
    </style>
</head>
<body>
    <div id="toastContainer"></div>
    
    <header>
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon">H</div>
                <span>HOZYA EMPIRE</span>
            </div>
            <div class="profile-dropdown">
                <div class="profile-icon" aria-label="–ú–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è" id="profileMenu">
                    <img src="profile-icon.jpg" alt="–ü—Ä–æ—Ñ–∏–ª—å" style="width: 38px; height: 38px; border-radius: 50%;">
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="radio-inputs">
            <label class="radio">
                <input type="radio" name="radio" <?php echo ($active_section ?? 'profile') === 'profile' ? 'checked' : ''; ?> data-section="profile">
                <span class="name">–ü—Ä–æ—Ñ–∏–ª—å</span>
            </label>
            <label class="radio">
                <input type="radio" name="radio" <?php echo ($active_section ?? 'profile') === 'groups' ? 'checked' : ''; ?> data-section="groups">
                <span class="name">–ë–µ—Å–µ–¥—ã</span>
            </label>
            <label class="radio">
                <input type="radio" name="radio" <?php echo ($active_section ?? 'profile') === 'panel' ? 'checked' : ''; ?> data-section="panel">
                <span class="name">–ü–∞–Ω–µ–ª—å</span>
            </label>
        </div>

        <div id="loading-overlay" class="loading-overlay" style="display: none;">
            <div class="loading-indicator">
                <div class="spinner"></div>
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö...</p>
            </div>
        </div>

        <section id="profile-section" class="content-section <?php echo ($active_section ?? 'profile') === 'profile' ? 'active' : ''; ?>">
            <?php if (isset($site) && $site): ?>
                <div class="card">
                    <h2 class="text-gradient">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h2>
                    
                    <div class="avatar-container">
                        <img src="<?php 
                            if (isset($site['avatar_url']) && intval($site['avatar_url']) == 1) {
                                $avatar = "profile-icon.jpg"; 
                            } else {
                                $avatar = $site['avatar_url'] ?? "profile-icon.jpg";
                            } 
                            echo htmlspecialchars($avatar); 
                        ?>" alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" class="avatar">
                        
                        <?php if (isset($site['vip']) && $site['vip'] > 0): ?>
                            <?php
                            $vip_name = [
                                1 => "DEF –•–æ–∑—è–µ–Ω—ë–Ω–æ–∫",
                                2 => "VIP –•–æ–∑—è–µ–Ω—ë–Ω–æ–∫",
                                3 => "PREMIUM –•–æ–∑—è–µ–Ω—ë–Ω–æ–∫",
                            ];
                            $vip = $vip_name[$site['vip']] ?? false;
                            ?>
                            <?php if ($vip): ?>
                                <span class="badge vip"><?php echo htmlspecialchars($vip); ?></span>
                            <?php endif; ?>
                        <?php endif; ?>
                    </div>
                    
                    <div class="user-info">
                        <div class="info-row">
                            <strong>–ù–∏–∫ –≤ —Å–∏—Å—Ç–µ–º–µ:</strong>
                            <span><?php echo htmlspecialchars($site['Text'] ?? '–ù–µ —É–∫–∞–∑–∞–Ω'); ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–ü—Ä–∞–≤–∞ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</strong>
                            <span>
                                <?php
                                $admin_names = [
                                    0 => "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                                    1 => "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
                                    2 => "–°—É–ø–µ—Ä-–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
                                ];
                                echo htmlspecialchars($admin_names[$site['is_admin'] ?? 0] ?? "–û—à–∏–±–∫–∞");
                                ?>
                            </span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong>
                            <span>@<?php echo htmlspecialchars($site['username'] ?? '–ù–µ —É–∫–∞–∑–∞–Ω'); ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>ID:</strong>
                            <span><?php echo htmlspecialchars($site['tg_id'] ?? '–ù–µ —É–∫–∞–∑–∞–Ω'); ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–µ–ø–µ–π:</strong>
                            <span><?php echo htmlspecialchars($site['cep'] ?? '0'); ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–†–∞–Ω–≥ –≤ —Å–∏—Å—Ç–µ–º–µ:</strong>
                            <span>
                                <?php
                                $rank_names = [
                                    3 => "üîß –•–æ–∑—è–µ—Ç—Ä—É–¥–Ω–∏–∫",
                                    4 => "üõ°Ô∏è –•–æ–∑—è–µ—Å—Ç—Ä–∞–∂",
                                    5 => "üéì –•–æ–∑—è–µ–º–∞—Å—Ç–µ—Ä",
                                    7 => "üë∂ –ü—É–ø—Å–∏–∫",
                                    8 => "üí∞ $ –ú–∞–∂–æ—Ä $",
                                    9 => "üëî –ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å",
                                    10 => "üëë –ì–ª.–•–û–ó–Ø–ò–ù",
                                    11 => "üë§ –ì–ª.–ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å",
                                ];
                                echo htmlspecialchars($rank_names[$site['rang'] ?? 0] ?? "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π");
                                ?>
                            </span>
                            <span class="badge rank">–†–∞–Ω–≥</span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è:</strong>
                            <span>
                                <?php
                                $months = [
                                    1 => '—è–Ω–≤–∞—Ä—è', 2 => '—Ñ–µ–≤—Ä–∞–ª—è', 3 => '–º–∞—Ä—Ç–∞', 4 => '–∞–ø—Ä–µ–ª—è', 5 => '–º–∞—è', 6 => '–∏—é–Ω—è',
                                    7 => '–∏—é–ª—è', 8 => '–∞–≤–≥—É—Å—Ç–∞', 9 => '—Å–µ–Ω—Ç—è–±—Ä—è', 10 => '–æ–∫—Ç—è–±—Ä—è', 11 => '–Ω–æ—è–±—Ä—è', 12 => '–¥–µ–∫–∞–±—Ä—è'
                                ];
                                
                                if (isset($bday) && $bday && isset($bday['birthday'])) {
                                    $birthday = $bday['birthday'];
                                    if (strpos($birthday, '.') !== false && strlen($birthday) == 5) {
                                        $birthday .= '.' . date('Y');
                                    }
                                    $date = strtotime($birthday);
                                    if ($date !== false) {
                                        $day = date('j', $date);
                                        $monthNumber = (int)date('m', $date);
                                        $month = $months[$monthNumber] ?? '';
                                        echo htmlspecialchars($day . ' ' . $month);
                                    } else {
                                        echo '–û—à–∏–±–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã!';
                                    }
                                } else {
                                    echo '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
                                }
                                ?>
                            </span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–í–∞—à –≥–æ—Ä–æ–¥:</strong>
                            <span><?php echo htmlspecialchars($site['city'] ?? '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'); ?></span>
                        </div>
                        
                        <div style="margin-top: 24px;">
                            <button type="button" class="btn warning" onclick="window.location.href='/map'">
                                –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ä—Ç—É
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2 class="text-gradient">–í–∞—à–∏ –±–∞–ª–∞–Ω—Å—ã</h2>
                    
                    <div class="info-row">
                        <strong>Hozyaecoin:</strong>
                        <span><?php echo number_format($site['money'] ?? 0, 0, ".", ","); ?> ¬£ hoz</span>
                    </div>
                    
                    <div class="info-row">
                        <strong>üëæ BTC:</strong>
                        <span><?php echo number_format($site['btc'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                    
                    <div class="info-row">
                        <strong>üé© ETH:</strong>
                        <span><?php echo number_format($site['eth'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                    
                    <div class="info-row">
                        <strong>üëæ TON:</strong>
                        <span><?php echo number_format($site['ton'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                </div>

                <div class="card">
                    <h2 class="text-gradient">ü§µüèª –•üÖæÔ∏è–ó–Ø–ï–íüÖ∞Ô∏è | –úüÖ∞Ô∏è–§–ò–Ø</h2>
                    
                    <div class="info-row">
                        <strong>üíé –ö–∞–º–Ω–µ–π:</strong>
                        <span><?php echo number_format($site['kamni'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                    
                    <div class="info-row">
                        <strong>üíµ –î–µ–Ω—å–≥–∏:</strong>
                        <span><?php echo number_format($site['moneymaf'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                    
                    <div class="info-row">
                        <strong>üõ° –ó–∞—â–∏—Ç–∞:</strong>
                        <span><?php echo number_format($site['maf_protect'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                    
                    <div class="info-row">
                        <strong>üìë –î–æ–∫—É–º–µ–Ω—Ç—ã:</strong>
                        <span><?php echo number_format($site['maf_doc'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                    
                    <div class="info-row">
                        <strong>üéé –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–æ–ª—å:</strong>
                        <span><?php echo number_format($site['maf_activerole'] ?? 0, 0, ".", ","); ?></span>
                    </div>
                </div>

                <div class="card">
                    <h2 class="text-gradient">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∏–º—É—â–µ—Å—Ç–≤–æ</h2>
                    
                    <div class="property-grid">
                        <div class="info-row">
                            <strong>–ê–≤—Ç–æ–º–æ–±–∏–ª—å:</strong>
                            <span><?php echo !empty($site['cars']) ? htmlspecialchars($site['cars']) : '–ù–µ—Ç—É'; ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å:</strong>
                            <span><?php echo !empty($site['houses']) ? htmlspecialchars($site['houses']) : '–ù–µ—Ç—É'; ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–Ø—Ö—Ç–∞:</strong>
                            <span><?php echo !empty($site['yachts']) ? htmlspecialchars($site['yachts']) : '–ù–µ—Ç—É'; ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–°–∞–º–æ–ª–µ—Ç:</strong>
                            <span><?php echo !empty($site['planes']) ? htmlspecialchars($site['planes']) : '–ù–µ—Ç—É'; ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–í–µ—Ä—Ç–æ–ª–µ—Ç:</strong>
                            <span><?php echo !empty($site['helicopters']) ? htmlspecialchars($site['helicopters']) : '–ù–µ—Ç—É'; ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong>
                            <span><?php echo !empty($site['phones']) ? htmlspecialchars($site['phones']) : '–ù–µ—Ç—É'; ?></span>
                        </div>
                        
                        <div class="info-row">
                            <strong>–ö–æ–º–ø—å—é—Ç–µ—Ä:</strong>
                            <span><?php echo !empty($site['pcs']) ? htmlspecialchars($site['pcs']) : '–ù–µ—Ç—É'; ?></span>
                        </div>
                    </div>

                    <div style="margin: 32px 0; height: 1px; background: rgba(255, 255, 255, 0.1);"></div>

                    <h3 style="margin-bottom: 20px;">üíº –ë–∏–∑–Ω–µ—Å—ã</h3>
                    <div class="property-grid">
                        <?php
                        $businesses = [
                            "bukmek" => "–ë—É–∫–º–µ–∫–µ—Ä—Å–∫–∞—è –∫–æ–Ω—Ç–æ—Ä–∞",
                            "magazin" => "–ú–∞–≥–∞–∑–∏–Ω",
                            "kafe" => "–ö–∞—Ñ–µ",
                            "restoran" => "–†–µ—Å—Ç–æ—Ä–∞–Ω",
                            "bar" => "–ë–∞—Ä",
                            "nightclub" => "–ù–æ—á–Ω–æ–π –∫–ª—É–±",
                            "autoshop" => "–ê–≤—Ç–æ–º–∞–≥–∞–∑–∏–Ω",
                            "cinema" => "–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä",
                            "hotel" => "–û—Ç–µ–ª—å",
                            "casino" => "–ö–∞–∑–∏–Ω–æ"
                        ];

                        $hasBiz = false;
                        foreach ($businesses as $key => $name) {
                            if (!empty($site["biz_{$key}"])) {
                                $hasBiz = true;
                                $level = !empty($site["biz_{$key}_level"]) ? $site["biz_{$key}_level"] : 1;
                                echo "<div class='info-row'><strong>{$name}:</strong><span>–£—Ä–æ–≤–µ–Ω—å {$level}</span></div>";
                            }
                        }
                        if (!$hasBiz) {
                            echo "<div class='info-row'><strong>–ë–∏–∑–Ω–µ—Å—ã:</strong><span>‚ùå –£ –≤–∞—Å –Ω–µ—Ç –±–∏–∑–Ω–µ—Å–æ–≤</span></div>";
                        }
                        ?>
                    </div>

                    <div style="margin: 32px 0; height: 1px; background: rgba(255, 255, 255, 0.1);"></div>

                    <h3 style="margin-bottom: 20px;">üéÅ –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</h3>
                    <div class="property-grid">
                        <?php
                        $accessories = [
                            "nimb" => "–ù–∏–º–±",
                            "shar" => "–®–∞—Ä",
                            "bronzovy_medal" => "–ë—Ä–æ–Ω–∑–æ–≤–∞—è –º–µ–¥–∞–ª—å",
                            "serebryany_medal" => "–°–µ—Ä–µ–±—Ä—è–Ω–∞—è –º–µ–¥–∞–ª—å",
                            "zolotoy_medal" => "–ó–æ–ª–æ—Ç–∞—è –º–µ–¥–∞–ª—å",
                            "angel_wings" => "–ö—Ä—ã–ª—å—è –∞–Ω–≥–µ–ª–∞",
                            "devil_horn" => "–†–æ–≥–∞ –¥—å—è–≤–æ–ª–∞",
                            "diamond_ring" => "–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤–æ–µ –∫–æ–ª—å—Ü–æ",
                            "magic_orb" => "–í–æ–ª—à–µ–±–Ω—ã–π —à–∞—Ä",
                            "crown" => "–ö–æ—Ä–æ–Ω–∞"
                        ];

                        $hasAcc = false;
                        foreach ($accessories as $key => $name) {
                            if (!empty($site["acc_{$key}"])) {
                                $hasAcc = true;
                                echo "<div class='info-row'><strong>{$name}:</strong><span>‚úÖ</span></div>";
                            }
                        }
                        if (!$hasAcc) {
                            echo "<div class='info-row'><strong>–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã:</strong><span>‚ùå –£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤</span></div>";
                        }
                        ?>
                    </div>
                </div>
                
                <?php if (isset($message_counts) && isset($dates)): ?>
                <div class="card">
                    <h2 class="text-gradient">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</h2>
                    
                    <?php
                    $total_messages = array_sum($message_counts);
                    $average_per_day = $total_messages > 0 ? round($total_messages / 7) : 0;
                    $max_per_day = max($message_counts);
                    ?>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                        <div class="info-row">
                            <strong>–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π:</strong>
                            <span><?php echo $total_messages; ?></span>
                        </div>
                        <div class="info-row">
                            <strong>–í —Å—Ä–µ–¥–Ω–µ–º –≤ –¥–µ–Ω—å:</strong>
                            <span><?php echo $average_per_day; ?></span>
                        </div>
                        <div class="info-row">
                            <strong>–ú–∞–∫—Å–∏–º—É–º –≤ –¥–µ–Ω—å:</strong>
                            <span><?php echo $max_per_day; ?></span>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="messageChart"></canvas>
                    </div>
                </div>
                <?php endif; ?>

                <?php if (isset($groupedLogs) && !empty($groupedLogs)): ?>
                <div class="card">
                    <h2 class="text-gradient">–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π</h2>
                    
                    <div class="days-tabs" style="display: flex; gap: 8px; margin-bottom: 24px; overflow-x: auto; padding-bottom: 8px;">
                        <?php 
                        $first = true;
                        foreach ($groupedLogs as $day => $dayLogs): 
                            $today = date('Y-m-d');
                            $yesterday = date('Y-m-d', strtotime('-1 day'));
                            
                            if ($day === $today) {
                                $displayName = '–°–µ–≥–æ–¥–Ω—è';
                            } elseif ($day === $yesterday) {
                                $displayName = '–í—á–µ—Ä–∞';
                            } else {
                                $displayName = date('d.m', strtotime($day));
                            }
                            
                            $financeCount = 0;
                            $systemCount = 0;
                            foreach ($dayLogs as $log) {
                                if (strpos(strtolower($log['log_text']), '–¥–µ–Ω—å–≥–∏') !== false || 
                                    strpos(strtolower($log['log_text']), '—Å—Ç–∞–≤–∫') !== false ||
                                    strpos(strtolower($log['log_text']), '–≤—ã–∏–≥—Ä–∞–ª') !== false ||
                                    strpos(strtolower($log['log_text']), '–ø—Ä–æ–∏–≥—Ä–∞–ª') !== false) {
                                    $financeCount++;
                                } else {
                                    $systemCount++;
                                }
                            }
                        ?>
                            <button class="day-tab <?php echo $first ? 'active' : ''; ?>" data-day="<?php echo htmlspecialchars($day); ?>">
                                <span style="display: block; font-weight: 600;"><?php echo htmlspecialchars($displayName); ?></span>
                                <span style="font-size: 12px; color: var(--text-secondary);">
                                    <?php echo count($dayLogs); ?> —Å–æ–±—ã—Ç–∏–π
                                </span>
                            </button>
                        <?php 
                            $first = false;
                        endforeach; 
                        ?>
                    </div>
                    
                    <div class="logs-timeline">
                        <?php foreach ($groupedLogs as $day => $dayLogs): ?>
                            <div class="day-activities" data-day="<?php echo htmlspecialchars($day); ?>" style="<?php echo ($day === date('Y-m-d')) ? '' : 'display:none;'; ?>">
                                <?php foreach ($dayLogs as $log): 
                                    $category = 'system';
                                    if (strpos(strtolower($log['log_text']), '–¥–µ–Ω—å–≥–∏') !== false || 
                                        strpos(strtolower($log['log_text']), '—Å—Ç–∞–≤–∫') !== false ||
                                        strpos(strtolower($log['log_text']), '–≤—ã–∏–≥—Ä–∞–ª') !== false ||
                                        strpos(strtolower($log['log_text']), '–ø—Ä–æ–∏–≥—Ä–∞–ª') !== false) {
                                        $category = 'finance';
                                    }
                                    
                                    $timeAgo = '';
                                    if (isset($log['created_at'])) {
                                        $now = new DateTime();
                                        $date = new DateTime($log['created_at']);
                                        $diff = $now->diff($date);
                                        
                                        if ($diff->days > 7) {
                                            $timeAgo = date('d.m.Y', strtotime($log['created_at']));
                                        } elseif ($diff->days > 0) {
                                            $timeAgo = $diff->days . ' –¥. –Ω–∞–∑–∞–¥';
                                        } elseif ($diff->h > 0) {
                                            $timeAgo = $diff->h . ' —á. –Ω–∞–∑–∞–¥';
                                        } elseif ($diff->i > 0) {
                                            $timeAgo = $diff->i . ' –º–∏–Ω. –Ω–∞–∑–∞–¥';
                                        } else {
                                            $timeAgo = '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
                                        }
                                    }
                                ?>
                                    <div class="log-item <?php echo $category; ?>">
                                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                                            <div style="
                                                width: 32px;
                                                height: 32px;
                                                border-radius: 50%;
                                                background: <?php echo $category === 'finance' ? 'var(--success)' : 'var(--info)'; ?>;
                                                display: flex;
                                                align-items: center;
                                                justify-content: center;
                                                flex-shrink: 0;
                                            ">
                                                <?php if ($category === 'finance'): ?>
                                                    üí∞
                                                <?php else: ?>
                                                    ‚öôÔ∏è
                                                <?php endif; ?>
                                            </div>
                                            <div style="flex: 1;">
                                                <div style="color: var(--text); margin-bottom: 4px;">
                                                    <?php echo htmlspecialchars($log['log_text']); ?>
                                                </div>
                                                <div style="color: var(--text-secondary); font-size: 14px; display: flex; justify-content: space-between;">
                                                    <span><?php echo htmlspecialchars($category === 'finance' ? '–§–∏–Ω–∞–Ω—Å—ã' : '–°–∏—Å—Ç–µ–º–∞'); ?></span>
                                                    <span><?php echo htmlspecialchars($timeAgo); ?></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                <?php endforeach; ?>
                            </div>
                        <?php endforeach; ?>
                    </div>
                </div>
                <?php endif; ?>
            <?php else: ?>
                <div class="card">
                    <h2>–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</h2>
                    <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.</p>
                </div>
            <?php endif; ?>
        </section>

        <section id="groups-section" class="content-section <?php echo ($active_section ?? 'profile') === 'groups' ? 'active' : ''; ?>">
            <?php if (isset($from_id) && isset($site)): ?>
                <div class="card">
                    <h2 class="text-gradient">–ú–æ–∏ –±–µ—Å–µ–¥—ã</h2>
                    <div class="peers-list">
                        <?php
                        if (isset($con)) {
                            $stmt = $con->prepare("SELECT peer FROM tg_nlist WHERE tg_id = ?");
                            $stmt->execute([$from_id]);
                            $peers = $stmt->fetchAll(PDO::FETCH_ASSOC);
                            
                            if (count($peers) > 0) {
                                foreach ($peers as $peer): 
                                    if($peer['peer'] == '-1002483132170') {
                                        $name = "–•üÖæÔ∏è–ó–Ø–ï–íüÖ∞Ô∏è | BO"; 
                                        $owner_name = "s69xüòà";
                                        $owner_link = "samp69x";
                                    } else {
                                        $name = "#–í–û || –•–û–ó–Ø–ï–í–ê || –ú–∞—Å—Å–æ–Ω—ã";
                                        $owner_name = "‚Äùdavid‚Äù ü•∂ ";
                                        $owner_link = "david_dream";
                                    }
                                    
                                    $stmt = $con->prepare("SELECT date FROM all_message WHERE peer = ? ORDER BY date DESC LIMIT 1");
                                    $stmt->execute([$peer['peer']]);
                                    $lastMessage = $stmt->fetch(PDO::FETCH_ASSOC);
                                    
                                    $sitepeer = $peer['peer'];
                                    $response = @file_get_contents(
                                        "https://api.telegram.org/bot7829579595:AAFYq5Qmo6dA6DA5jn9g2hKn-Uedt6jnB7A/getChatMemberCount?chat_id=$sitepeer"
                                    );
                                    $data = json_decode($response, true);
                        ?>
                        <div class="user-card">
                            <div style="display: flex; align-items: center; gap: 16px; flex: 1;">
                                <img src="/profile-icon.jpg" alt="–ê–≤–∞—Ç–∞—Ä –±–µ—Å–µ–¥—ã" style="width: 48px; height: 48px; border-radius: 50%;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;"><?php echo htmlspecialchars($name); ?></div>
                                    <div style="color: var(--text-secondary); font-size: 14px;">
                                        –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: <?php echo $data["result"] ?? 'N/A'; ?> ‚Ä¢ 
                                        –í–ª–∞–¥–µ–ª–µ—Ü: <a href="https://t.me/<?php echo htmlspecialchars($owner_link); ?>" style="color: var(--primary); text-decoration: none;">
                                            <?php echo htmlspecialchars($owner_name); ?>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <a href="mini-app-infopeer?id=<?php echo urlencode($peer['peer']); ?>" class="btn purple">
                                –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                            </a>
                        </div>
                        <?php endforeach; 
                            } else { ?>
                            <div style="text-align: center; padding: 48px 24px; color: var(--text-secondary);">
                                <div style="font-size: 48px; margin-bottom: 16px;">üí¨</div>
                                <p style="font-size: 18px; margin-bottom: 8px;">–£ –≤–∞—Å –ø–æ–∫–∞ —á—Ç–æ –Ω–µ—Ç –±–µ—Å–µ–¥</p>
                                <p style="color: var(--text-secondary);">–ù–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∑–¥–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å—Å—è :)</p>
                            </div>
                            <?php } 
                        } else { ?>
                            <div class="info-row">
                                <strong>–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong>
                                <span>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±–µ—Å–µ–¥</span>
                            </div>
                        <?php } ?>
                    </div>
                </div>
            <?php else: ?>
                <div class="card">
                    <h2>–û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</h2>
                    <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.</p>
                </div>
            <?php endif; ?>
        </section>

        <section id="panel-section" class="content-section <?php echo ($active_section ?? 'profile') === 'panel' ? 'active' : ''; ?>">
            <div class="card">
                <h2 class="text-gradient">
                    –ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª–∏ –û–Ω–ª–∞–π–Ω
                    <span id="refreshTimer" style="font-size: 14px; color: var(--text-secondary); float: right;">
                        –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑: 5 —Å–µ–∫
                    </span>
                </h2>
                
                <div class="user-list" id="onlineUsersList">
                    <?php
                    if (isset($online_list) && !empty($online_list)) {
                        foreach($online_list as $nick => $data): ?>
                        <div class="user-card">
                            <div style="flex: 1;">
                                <div style="font-weight: 600; margin-bottom: 4px;"><?php echo htmlspecialchars($nick); ?></div>
                                <div style="display: flex; gap: 16px; color: var(--text-secondary); font-size: 14px;">
                                    <span>–û–Ω–ª–∞–π–Ω –∑–∞ –Ω–µ–¥–µ–ª—é: <?php echo isset($data['weekly']) ? htmlspecialchars($data['weekly']) : '0 –º–∏–Ω'; ?></span>
                                </div>
                            </div>
                            <div class="user-status <?php echo ($data['status'] === '–≤ —Å–µ—Ç–∏') ? 'status-online' : 'status-offline'; ?>">
                                <?php echo htmlspecialchars($data['status']); ?>
                            </div>
                        </div>
                        <?php endforeach;
                    } else { ?>
                        <div style="text-align: center; padding: 32px; color: var(--text-secondary);">
                            –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–º–µ—Å—Ç–∏—Ç–µ–ª—è—Ö
                        </div>
                    <?php } ?>
                </div>
            </div>

            <?php if (isset($sitecheck) && $sitecheck && $sitecheck['is_admin'] >= 1): ?>
            <div class="card">
                <h2 class="text-gradient">–î–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                
                <form id="userActionForm" style="margin-top: 24px;">
                    <div class="form-group">
                        <label class="form-label">–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                        <input type="text" name="target_nick" class="form-input" placeholder="–ù–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-top: 24px;">
                        <button type="button" class="btn purple" onclick="openModal('rankModal')">
                            –°–º–µ–Ω–∏—Ç—å —Ä–∞–Ω–≥
                        </button>
                        <button type="button" class="btn warning" onclick="openModal('warningModal')">
                            –í—ã–¥–∞—Ç—å –≤—ã–≥–æ–≤–æ—Ä
                        </button>
                        <button type="button" class="btn warning" onclick="openModal('muteModal')">
                            –í—ã–¥–∞—Ç—å –º—É—Ç
                        </button>
                        <button type="button" class="btn danger" onclick="openModal('banModal')">
                            –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button type="button" class="btn danger" onclick="openModal('kickModal')">
                            –ò—Å–∫–ª—é—á–∏—Ç—å
                        </button>
                    </div>
                </form>
            </div>
            <?php endif; ?>
        </section>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <?php if (isset($sitecheck) && $sitecheck && $sitecheck['is_admin'] >= 1): ?>
    <div id="warningModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–í—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</h3>
                <span class="close" onclick="closeModal('warningModal')">&times;</span>
            </div>
            <form class="ajax-form" data-action="warning">
                <div class="form-group">
                    <label class="form-label">–ù–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" name="target_nick" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ü—Ä–∏—á–∏–Ω–∞:</label>
                    <input type="text" name="warning_reason" class="form-input" required>
                </div>
                <div style="display: flex; gap: 12px; margin-top: 32px;">
                    <button type="button" class="btn danger" onclick="closeModal('warningModal')" style="flex: 1;">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn" style="flex: 1;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="rankModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–°–º–µ–Ω–∏—Ç—å —Ä–∞–Ω–≥</h3>
                <span class="close" onclick="closeModal('rankModal')">&times;</span>
            </div>
            <form class="ajax-form" data-action="rank">
                <div class="form-group">
                    <label class="form-label">–ù–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" name="target_nick" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ù–æ–≤—ã–π —Ä–∞–Ω–≥:</label>
                    <select name="rank" class="form-select" required>
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–Ω–≥ --</option>
                        <option value="3">üîß –•–æ–∑—è–µ—Ç—Ä—É–¥–Ω–∏–∫</option>
                        <option value="4">üõ°Ô∏è –•–æ–∑—è–µ—Å—Ç—Ä–∞–∂</option>
                        <option value="5">üéì –•–æ–∑—è–µ–º–∞—Å—Ç–µ—Ä</option>
                        <option value="7">üë∂ –ü—É–ø—Å–∏–∫</option>
                        <option value="8">üí∞ $ –ú–∞–∂–æ—Ä $</option>
                        <option value="9">üëî –ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å</option>
                        <option value="10">üëë –ì–ª.–•–û–ó–Ø–ò–ù</option>
                        <option value="11">üë§ –ì–ª.–ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å</option>
                    </select>
                </div>
                <div style="display: flex; gap: 12px; margin-top: 32px;">
                    <button type="button" class="btn danger" onclick="closeModal('rankModal')" style="flex: 1;">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn" style="flex: 1;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –î—Ä—É–≥–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ -->
    <?php endif; ?>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const radios = document.querySelectorAll('input[name="radio"]');
            const sections = document.querySelectorAll('.content-section');
            const loadingOverlay = document.getElementById('loading-overlay');

            radios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked) {
                        const sectionId = this.dataset.section;
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                        loadingOverlay.style.display = 'flex';
                        
                        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
                        sections.forEach(section => {
                            section.classList.remove('active');
                        });
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
                        setTimeout(() => {
                            document.getElementById(`${sectionId}-section`).classList.add('active');
                            loadingOverlay.style.display = 'none';
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º URL –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
                            const url = new URL(window.location);
                            url.searchParams.set('section', sectionId);
                            window.history.replaceState({}, '', url);
                        }, 300);
                    }
                });
            });

            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–Ω–µ–π –≤ –ª–æ–≥–∞—Ö
            const dayTabs = document.querySelectorAll('.day-tab');
            const dayActivities = document.querySelectorAll('.day-activities');

            dayTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const day = this.dataset.day;
                    
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Ç–∞–±–æ–≤
                    dayTabs.forEach(t => t.classList.remove('active'));
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–º—É —Ç–∞–±—É
                    this.classList.add('active');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–Ω—å, —Å–∫—Ä—ã–≤–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ
                    dayActivities.forEach(activity => {
                        activity.style.display = activity.dataset.day === day ? 'block' : 'none';
                    });
                });
            });

            // –ì—Ä–∞—Ñ–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
            <?php if (isset($message_counts) && isset($dates)): ?>
            const ctx = document.getElementById('messageChart');
            if (ctx) {
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: <?php echo json_encode($dates); ?>,
                        datasets: [{
                            label: '–°–æ–æ–±—â–µ–Ω–∏–π',
                            data: <?php echo json_encode($message_counts); ?>,
                            backgroundColor: 'rgba(139, 92, 246, 0.6)',
                            borderColor: 'rgba(139, 92, 246, 1)',
                            borderWidth: 1,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#f1f5f9'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            }
            <?php endif; ?>

            // –¢–∞–π–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            let refreshTimer = 5;
            const timerElement = document.getElementById('refreshTimer');
            
            function updateTimer() {
                if (timerElement) {
                    refreshTimer--;
                    timerElement.textContent = `–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑: ${refreshTimer} —Å–µ–∫`;
                    
                    if (refreshTimer <= 0) {
                        refreshTimer = 5;
                        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                    }
                }
            }
            
            setInterval(updateTimer, 1000);

            // Telegram Web App
            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
                Telegram.WebApp.setBackgroundColor('#0f172a');
                Telegram.WebApp.setHeaderColor('#0f172a');
            }

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º
            const forms = document.querySelectorAll('.ajax-form');
            forms.forEach(form => {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞...';
                    submitBtn.disabled = true;
                    
                    try {
                        const formData = new FormData(this);
                        const response = await fetch('', {
                            method: 'POST',
                            body: formData
                        });
                        
                        const result = await response.json();
                        showToast(result.message || '–£—Å–ø–µ—à–Ω–æ!', result.success ? 'success' : 'error');
                        
                        if (result.success) {
                            closeModal(this.dataset.action + 'Modal');
                            this.reset();
                        }
                    } catch (error) {
                        showToast('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
                    } finally {
                        submitBtn.textContent = originalText;
                        submitBtn.disabled = false;
                    }
                });
            });
        });

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function openModal(id) {
            const mainFormNick = document.querySelector('input[name="target_nick"]').value;
            const modalInput = document.querySelector(`#${id} input[name="target_nick"]`);
            
            if (modalInput && mainFormNick) {
                modalInput.value = mainFormNick;
            }
            
            document.getElementById(id).style.display = 'block';
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });
    </script>
</body>
</html>